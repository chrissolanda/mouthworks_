module.exports=[98049,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(21937),e=a.i(96313),f=a.i(3130),g=a.i(40695),h=a.i(30617),i=a.i(41675),j=a.i(46842),k=a.i(11156),l=a.i(67937),l=l,m=a.i(41710),n=a.i(81560),o=a.i(24569),p=a.i(15618),q=a.i(16201),r=a.i(2288),s=a.i(33508),t=a.i(92e3),u=a.i(97895);function v({onClose:a,onSubmit:d}){let[e,f]=(0,c.useState)({service:"",date:"",time:"",notes:""}),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(!0),[l,m]=(0,c.useState)("");(0,c.useEffect)(()=>{(async()=>{try{let a=await r.treatmentService.getAll().catch(()=>[]);i(a||[])}catch(a){console.error("[v0] Error loading treatments:",a),m("Failed to load available services")}finally{k(!1)}})()},[]);let n=(()=>{let a=[],b=new Date;for(let c=1;c<=14;c++){let d=new Date(b);d.setDate(d.getDate()+c),a.push(d.toISOString().split("T")[0])}return a})();return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-card rounded-lg shadow-2xl max-w-md w-full max-h-[90vh] flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-foreground",children:"Book an Appointment"}),(0,b.jsx)("button",{onClick:a,className:"p-1 hover:bg-muted rounded-lg transition-colors",children:(0,b.jsx)(s.X,{className:"w-5 h-5"})})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[l&&(0,b.jsxs)("div",{className:"p-3 bg-destructive/10 border border-destructive/30 rounded-lg flex gap-2",children:[(0,b.jsx)(t.AlertCircle,{className:"w-5 h-5 text-destructive flex-shrink-0 mt-0.5"}),(0,b.jsx)("p",{className:"text-sm text-destructive",children:l})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"block text-sm font-semibold text-foreground",children:["Service ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),j?(0,b.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"Loading services..."}):0===h.length?(0,b.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No services available"}):(0,b.jsxs)("select",{value:e.service,onChange:a=>{f(b=>({...b,service:a.target.value})),m("")},className:"w-full px-3 py-2 border border-border rounded-lg bg-card text-foreground focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,b.jsx)("option",{value:"",children:"Select a service..."}),h.map(a=>(0,b.jsxs)("option",{value:a.name,children:[a.name," ",a.price?`- ${(0,u.formatCurrency)(a.price)}`:""]},a.id))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"block text-sm font-semibold text-foreground",children:["Preferred Date ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsxs)("select",{value:e.date,onChange:a=>{f(b=>({...b,date:a.target.value})),m("")},className:"w-full px-3 py-2 border border-border rounded-lg bg-card text-foreground focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,b.jsx)("option",{value:"",children:"Select a date..."}),n.map(a=>(0,b.jsx)("option",{value:a,children:new Date(a).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})},a))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"block text-sm font-semibold text-foreground",children:["Preferred Time ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-2",children:["09:00","09:30","10:00","10:30","11:00","11:30","14:00","14:30","15:00","15:30","16:00","16:30"].map(a=>(0,b.jsx)("button",{onClick:()=>{f(b=>({...b,time:a})),m("")},className:`p-2 border rounded-lg transition-colors text-sm font-medium ${e.time===a?"border-primary bg-primary/10 text-primary":"border-border hover:border-primary text-foreground hover:bg-muted"}`,children:a},a))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-foreground",children:"Additional Notes (Optional)"}),(0,b.jsx)("textarea",{value:e.notes,onChange:a=>f(b=>({...b,notes:a.target.value})),placeholder:"Any special requests or concerns...",className:"w-full px-3 py-2 border border-border rounded-lg bg-card text-foreground resize-none focus:outline-none focus:ring-2 focus:ring-primary",rows:3})]}),e.service&&e.date&&e.time&&(0,b.jsxs)("div",{className:"bg-muted/50 p-3 rounded-lg space-y-2 text-sm",children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Booking Summary:"}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Service:"})," ",e.service]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Date:"})," ",new Date(e.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Time:"})," ",e.time]})]})]})]}),(0,b.jsxs)("div",{className:"p-6 border-t border-border flex gap-2",children:[(0,b.jsx)(g.Button,{onClick:a,variant:"outline",className:"flex-1",children:"Cancel"}),(0,b.jsx)(g.Button,{onClick:()=>{e.service&&e.date&&e.time?d({service:e.service,date:e.date,time:e.time,notes:e.notes,status:"pending"}):m("Please fill in all required fields")},disabled:!e.service||!e.date||!e.time,className:"flex-1 bg-primary hover:bg-primary/90 text-primary-foreground",children:"Book Appointment"})]})]})})}function w(){let{user:a}=(0,d.useAuth)(),[s,t]=(0,c.useState)([]),[u,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(!0),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1);(0,c.useEffect)(()=>{(async()=>{try{if(!a?.id)return void y(!1);let b=await r.patientService.getByEmail(a.email);if(b?.id){w(b.id);let a=await r.appointmentService.getByPatientId(b.id);t(a||[])}else console.warn("[v0] Patient record not found for user:",a.email),t([])}catch(a){console.error("[v0] Error loading appointments:",a instanceof Error?a.message:a),t([])}finally{y(!1)}})()},[a?.id,a?.email]);let D=[{label:"Dashboard",icon:(0,b.jsx)(h.LayoutDashboard,{className:"w-5 h-5"}),href:"/patient/dashboard"},{label:"My Appointments",icon:(0,b.jsx)(i.Calendar,{className:"w-5 h-5"}),href:"/patient/appointments"},{label:"My Profile",icon:(0,b.jsx)(j.User,{className:"w-5 h-5"}),href:"/patient/profile"},{label:"Payment History",icon:(0,b.jsx)(k.CreditCard,{className:"w-5 h-5"}),href:"/patient/payments"}],E=async a=>{try{if(!u)return void alert("Error: Patient record not found. Please contact HR.");let b=await r.appointmentService.create({patient_id:u,service:a.service,date:a.date,time:a.time,notes:a.notes,status:"pending"});t([b,...s]),A(!1),C(!0),setTimeout(()=>C(!1),5e3)}catch(b){let a=b instanceof Error?b.message:JSON.stringify(b);console.error("[v0] Error booking appointment:",a),alert(`Error: ${a}`)}},F=async a=>{try{await r.appointmentService.delete(a),t(s.filter(b=>b.id!==a))}catch(a){console.error("[v0] Error cancelling appointment:",a)}},G=s.filter(a=>"pending"===a.status),H=s.filter(a=>"approved"===a.status||"confirmed"===a.status),I=s.filter(a=>"completed"===a.status),J=async a=>{try{let b=await r.appointmentService.changeStatus(a,"attended");t(c=>c.map(c=>c.id===a?b:c))}catch(a){console.error("[v0] Error marking attended:",a instanceof Error?a.message:String(a)),alert("Failed to mark as attended")}};return(0,b.jsxs)(e.default,{navItems:D,title:"My Appointments",children:[(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"My Appointments"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Book new appointments and view your scheduled visits"})]}),(0,b.jsxs)(g.Button,{onClick:()=>A(!0),className:"bg-primary hover:bg-primary/90 text-primary-foreground gap-2",children:[(0,b.jsx)(p.Plus,{className:"w-4 h-4"}),"Book Appointment"]})]}),B&&(0,b.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg flex gap-2 items-start",children:[(0,b.jsx)(q.CheckCircle,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-green-900",children:"Booking Accepted!"}),(0,b.jsx)("p",{className:"text-sm text-green-800",children:"Your appointment request has been submitted. HR will review and assign a dentist, then send it for approval."})]})]}),G.length>0&&(0,b.jsxs)(f.Card,{className:"border-yellow-200 bg-yellow-50/50",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Clock,{className:"w-5 h-5 text-yellow-600"}),"Pending Review (",G.length,")"]}),(0,b.jsx)(f.CardDescription,{className:"text-yellow-800",children:"Your booking requests are being reviewed by HR and a dentist will be assigned"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:G.map(a=>(0,b.jsxs)("div",{className:"p-4 border border-yellow-300 rounded-lg bg-white",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:a.service}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Awaiting HR assignment and dentist approval"})]}),(0,b.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-700",children:"Pending"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(l.default,{className:"w-4 h-4"}),new Date(a.date).toLocaleDateString()]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(m.Clock,{className:"w-4 h-4"}),a.time]})]}),a.notes&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-3",children:["Note: ",a.notes]}),(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",className:"text-xs text-destructive hover:bg-destructive/10 bg-transparent",onClick:()=>F(a.id),children:[(0,b.jsx)(n.Trash2,{className:"w-3 h-3 mr-1"}),"Cancel Request"]})]},a.id))})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.default,{className:"w-5 h-5 text-primary"}),"Upcoming Appointments"]}),(0,b.jsx)(f.CardDescription,{children:"Your scheduled appointments"})]}),(0,b.jsx)(f.CardContent,{children:x?(0,b.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):0===H.length?(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"No approved appointments yet. HR will schedule appointments that will appear here once your dentist approves them."})}):(0,b.jsx)("div",{className:"space-y-3",children:H.map(a=>(0,b.jsxs)("div",{className:"p-4 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:a.service}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["with ",a.dentists?.name||"Pending"]})]}),(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${"confirmed"===a.status||"approved"===a.status?"bg-green-100 text-green-700":"pending"===a.status?"bg-yellow-100 text-yellow-700":"attended"===a.status?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:a.status.charAt(0).toUpperCase()+a.status.slice(1)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(l.default,{className:"w-4 h-4"}),new Date(a.date).toLocaleDateString()]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(m.Clock,{className:"w-4 h-4"}),a.time]})]}),a.notes&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-3",children:["Note: ",a.notes]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[("approved"===a.status||"confirmed"===a.status)&&(0,b.jsx)(g.Button,{variant:"outline",size:"sm",className:"text-xs bg-transparent",onClick:()=>J(a.id),children:"Mark as Attended"}),(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",className:"text-xs bg-transparent",children:[(0,b.jsx)(o.Edit,{className:"w-3 h-3 mr-1"}),"Reschedule"]}),(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",className:"text-xs text-destructive hover:bg-destructive/10 bg-transparent",onClick:()=>F(a.id),children:[(0,b.jsx)(n.Trash2,{className:"w-3 h-3 mr-1"}),"Cancel"]})]})]},a.id))})})]}),I.length>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Completed Appointments"}),(0,b.jsx)(f.CardDescription,{children:"Your past dental visits"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:I.map(a=>(0,b.jsxs)("div",{className:"p-4 border border-border rounded-lg opacity-75 hover:opacity-100 transition-opacity",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-foreground",children:a.service}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["with ",a.dentists?.name]})]}),(0,b.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700",children:"Completed"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(l.default,{className:"w-4 h-4"}),new Date(a.date).toLocaleDateString()]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(m.Clock,{className:"w-4 h-4"}),a.time]})]})]},a.id))})})]})]}),z&&(0,b.jsx)(v,{onClose:()=>A(!1),onSubmit:E})]})}a.s(["default",()=>w],98049)}];

//# sourceMappingURL=app_patient_appointments_page_tsx_9d4bb62e._.js.map