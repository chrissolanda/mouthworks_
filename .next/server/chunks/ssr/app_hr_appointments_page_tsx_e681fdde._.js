module.exports=[29230,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(21937),e=a.i(96313),f=a.i(3130),g=a.i(40695),h=a.i(30617),i=a.i(60246),j=a.i(41675),k=a.i(34422),l=a.i(11156),m=a.i(83497),n=a.i(39761),o=a.i(21161),p=a.i(15618),q=a.i(81560),r=a.i(16201),s=a.i(62722),t=a.i(41710),u=a.i(70106);let v=(0,u.default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var w=a.i(2288),x=a.i(97895),y=a.i(33508);function z({onClose:a,onSubmit:d}){let[e,f]=(0,c.useState)({patient_id:"",patient_name:"",dentist_id:null,dentist_name:"",date:"",time:"",service:"",amount:0,notes:""}),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(null);(0,c.useEffect)(()=>{r()},[]);let r=async()=>{try{o(!0);let[a,b,c]=await Promise.all([w.patientService.getAll(),w.dentistService.getAll(),w.treatmentService.getAll()]);i(a||[]);let d=(b||[]).filter((a,b,c)=>{let d=(a?.email||"").trim().toLowerCase(),e=(a?.name||"").trim().toLowerCase(),f=d||e||a?.id;return c.findIndex(a=>{let b=(a?.email||"").trim().toLowerCase(),c=(a?.name||"").trim().toLowerCase();return(b||c||a?.id)===f})===b});k(d),m(c||[])}catch(a){q("Failed to load patients/dentists/services"),console.error("Error loading data:",a)}finally{o(!1)}},s=a=>{let{name:b,value:c}=a.target;if("service"===b){let a=l.find(a=>a.name===c),b=a?.price||t(c);f(a=>({...a,service:c,amount:b}))}else f(a=>({...a,[b]:c}))},t=a=>({Cleaning:500,"Tooth Cleaning":500,"Dental Cleaning":500,Filling:800,"Dental Filling":800,"Tooth Filling":800,"Root Canal":1500,"Root Canal Treatment":1500,Extraction:600,"Tooth Extraction":600,Whitening:2e3,"Teeth Whitening":2e3,Checkup:300,"Dental Checkup":300,Consultation:300,Braces:3e3,"Dental Braces":3e3,Crown:2500,"Dental Crown":2500})[a]||500;return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-card rounded-lg shadow-2xl max-w-md w-full max-h-96 overflow-y-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border sticky top-0 bg-card",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-foreground",children:"Schedule Appointment"}),(0,b.jsx)("button",{onClick:a,className:"p-1 hover:bg-muted rounded-lg transition-colors",children:(0,b.jsx)(y.X,{className:"w-5 h-5"})})]}),p&&(0,b.jsx)("div",{className:"p-4 bg-destructive/10 text-destructive text-sm",children:p}),(0,b.jsxs)("form",{onSubmit:a=>{if(a.preventDefault(),e.patient_id&&e.dentist_id&&e.date&&e.time){let a={patient_id:e.patient_id,dentist_id:e.dentist_id,date:e.date,time:e.time,service:e.service,notes:e.notes,status:"pending"};console.log("[v0] Submitting appointment for service:",e.service,"(price: ₱"+e.amount+" will be charged when completed)"),d(a)}else q("Please fill in all required fields including selecting a dentist")},className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Patient *"}),n?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading patients..."}):(0,b.jsxs)("select",{name:"patient_id",value:e.patient_id,onChange:a=>{let b=a.target.value,c=h.find(a=>a.id===b);f(a=>({...a,patient_id:b,patient_name:c?.name||""}))},className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select patient..."}),h.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-sm font-medium text-foreground",children:["Dentist ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),n?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading dentists..."}):0===j.length?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"No dentists available. Please add dentists first."}):(0,b.jsxs)("select",{name:"dentist_id",value:e.dentist_id||"",onChange:a=>{let b=a.target.value,c=j.find(a=>a.id===b);f(a=>({...a,dentist_id:""===b?null:b,dentist_name:c?.name||""}))},className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select dentist..."}),j.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"The selected dentist will be notified to approve this appointment"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Service"}),n?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading services..."}):0===l.length?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"No services available"}):(0,b.jsxs)("select",{name:"service",value:e.service,onChange:s,className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select service..."}),l.map(a=>(0,b.jsxs)("option",{value:a.name,children:[a.name," ",a.price?`- ${(0,x.formatCurrency)(a.price)}`:""]},a.id))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Date *"}),(0,b.jsx)("input",{type:"date",name:"date",value:e.date,onChange:s,className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Time *"}),(0,b.jsxs)("select",{name:"time",value:e.time,onChange:s,className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select time..."}),["09:00","10:00","11:00","14:00","15:00","16:00","17:00"].map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Notes (Optional)"}),(0,b.jsx)("textarea",{name:"notes",value:e.notes,onChange:s,placeholder:"Any special notes...",className:"w-full p-2 border border-border rounded-lg text-sm resize-none bg-background text-foreground",rows:3})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,b.jsx)(g.Button,{type:"button",onClick:a,variant:"outline",className:"flex-1 bg-transparent",children:"Cancel"}),(0,b.jsx)(g.Button,{type:"submit",className:"flex-1 bg-primary hover:bg-primary/90 text-primary-foreground",disabled:n,children:"Schedule"})]})]})]})})}function A({appointment:a,onClose:d,onAssign:e}){let[f,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(!0);return(0,c.useEffect)(()=>{(async()=>{try{let a=await w.dentistService.getAll().catch(()=>[]);h(a||[])}catch(a){console.error("[v0] Error loading dentists:",a)}finally{l(!1)}})()},[]),(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-card rounded-lg shadow-2xl max-w-md w-full",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-foreground",children:"Assign Dentist"}),(0,b.jsx)("button",{onClick:d,className:"p-1 hover:bg-muted rounded-lg transition-colors",children:(0,b.jsx)(y.X,{className:"w-5 h-5"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-3",children:["Patient: ",(0,b.jsx)("span",{className:"font-semibold text-foreground",children:a.patients?.name||a.patientName})]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Service: ",(0,b.jsx)("span",{className:"font-semibold text-foreground",children:a.service})]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Date & Time: ",(0,b.jsxs)("span",{className:"font-semibold text-foreground",children:[a.date," at ",a.time]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-foreground",children:"Select Dentist"}),k?(0,b.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"Loading dentists..."}):0===f.length?(0,b.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No dentists available"}):(0,b.jsx)("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:f.map(a=>(0,b.jsxs)("button",{onClick:()=>j(a.id),className:`w-full p-3 border rounded-lg transition-colors text-left ${i===a.id?"border-primary bg-primary/10":"border-border hover:border-primary"}`,children:[(0,b.jsxs)("p",{className:"font-medium text-foreground",children:["Dr. ",a.name]}),a.specialization&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.specialization})]},a.id))})]})]}),(0,b.jsxs)("div",{className:"p-6 border-t border-border flex gap-2",children:[(0,b.jsx)(g.Button,{onClick:d,variant:"outline",className:"flex-1",children:"Cancel"}),(0,b.jsx)(g.Button,{onClick:()=>{i&&e(i)},disabled:!i,className:"flex-1 bg-primary hover:bg-primary/90 text-primary-foreground",children:"Assign"})]})]})})}var B=a.i(5522),C=a.i(46842),D=a.i(35126);let E=(0,u.default)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var F=a.i(84505);let G=(0,u.default)("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);var H=a.i(40018);function I({appointment:a,onClose:d,onRecordPayment:e}){let[f,h]=(0,c.useState)({amount:String(a.amount||0),method:"Cash",notes:`${a.service||"Treatment"} - ${a.date}`}),[i,k]=(0,c.useState)(null),[l,n]=(0,c.useState)(!1),o=a=>{let{name:b,value:c}=a.target;h(a=>({...a,[b]:c}))},p=async b=>{if(b.preventDefault(),f.amount&&f.notes)try{let b=await e({method:f.method,amount:Number.parseFloat(f.amount),notes:f.notes}),c={receiptNumber:"string"==typeof b?b:`RCP-${Date.now()}`,date:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),patientName:a.patients?.name||"Unknown Patient",patientEmail:a.patients?.email,dentistName:a.dentists?.name||"Not Assigned",service:a.service||a.treatment||"Treatment",amount:Number.parseFloat(f.amount),method:f.method,notes:f.notes};k(c),n(!0)}catch(a){console.error("Error recording payment:",a)}};return l&&i?(0,b.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:(0,b.jsx)("div",{className:"bg-card rounded-xl shadow-2xl max-w-md w-full",children:(0,b.jsxs)("div",{className:"p-6 text-center space-y-6",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full mx-auto flex items-center justify-center",children:(0,b.jsx)(E,{className:"w-8 h-8 text-green-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Payment Recorded!"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Receipt #",i.receiptNumber," has been generated"]})]}),(0,b.jsxs)("div",{className:"bg-muted/50 rounded-lg p-4 text-left",children:[(0,b.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Amount:"}),(0,b.jsx)("span",{className:"font-bold",children:(0,x.formatCurrency)(i.amount)})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Method:"}),(0,b.jsx)("span",{className:"font-medium",children:i.method})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsxs)(g.Button,{onClick:()=>(0,H.downloadReceipt)(i),className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:[(0,b.jsx)(F.Download,{className:"w-4 h-4 mr-2"}),"Download Receipt"]}),(0,b.jsxs)(g.Button,{onClick:()=>(0,H.printReceipt)(i),variant:"outline",className:"w-full",children:[(0,b.jsx)(G,{className:"w-4 h-4 mr-2"}),"Print Receipt"]}),(0,b.jsx)(g.Button,{onClick:d,variant:"outline",className:"w-full mt-2",children:"Close"})]})]})})}):(0,b.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-card rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border sticky top-0 bg-card z-10",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Complete Appointment & Record Payment"}),(0,b.jsx)("button",{onClick:d,className:"p-2 hover:bg-muted rounded-lg transition-colors",children:(0,b.jsx)(y.X,{className:"w-5 h-5"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"bg-muted/50 rounded-lg p-6 space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-foreground mb-4",children:"Appointment Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(C.User,{className:"w-5 h-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Patient"}),(0,b.jsx)("p",{className:"text-base font-bold text-foreground",children:a.patients?.name||"Unknown"}),a.patients?.email&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.patients.email})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(D.Stethoscope,{className:"w-5 h-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Dentist"}),(0,b.jsx)("p",{className:"text-base font-bold text-foreground",children:a.dentists?.name||"Not Assigned"})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(j.Calendar,{className:"w-5 h-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Date & Time"}),(0,b.jsx)("p",{className:"text-base font-bold text-foreground",children:a.date}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.time})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(m.Package,{className:"w-5 h-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Service / Treatment"}),(0,b.jsx)("p",{className:"text-base font-bold text-foreground",children:a.service||a.treatment||"Not Specified"})]})]})]})]}),(0,b.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-foreground",children:"Payment Information"}),(0,b.jsx)("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-blue-700",children:"Appointment Amount"}),(0,b.jsx)("p",{className:"text-xs text-blue-600",children:"Expected payment for this service"})]}),(0,b.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:(0,x.formatCurrency)(a.amount||0)})]})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-foreground",children:"Amount Paid by Patient (₱) *"}),(0,b.jsx)(B.Input,{name:"amount",type:"number",step:"0.01",value:f.amount,onChange:o,placeholder:"0.00",className:"border-border h-11 text-lg font-bold",required:!0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enter the actual amount the patient paid"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-foreground",children:"Payment Method *"}),(0,b.jsxs)("select",{name:"method",value:f.method,onChange:o,className:"w-full px-3 py-2.5 h-11 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,b.jsx)("option",{children:"Cash"}),(0,b.jsx)("option",{children:"Bank Transfer"}),(0,b.jsx)("option",{children:"Credit Card"}),(0,b.jsx)("option",{children:"Debit Card"}),(0,b.jsx)("option",{children:"Check"}),(0,b.jsx)("option",{children:"Insurance"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-semibold text-foreground",children:"Notes / Description *"}),(0,b.jsx)("textarea",{name:"notes",value:f.notes,onChange:o,placeholder:"Payment details, receipt number, etc.",className:"w-full p-3 border border-border rounded-lg text-sm resize-none bg-background text-foreground",rows:3,required:!0})]}),(0,b.jsxs)("div",{className:"bg-primary/10 border-2 border-primary rounded-lg p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between pb-3 border-b border-primary/20",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"Appointment Amount:"}),(0,b.jsx)("span",{className:"text-lg font-bold text-foreground",children:(0,x.formatCurrency)(a.amount||0)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between pb-3 border-b border-primary/20",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Amount Paid:"}),(0,b.jsx)("span",{className:"text-2xl font-bold text-primary",children:(0,x.formatCurrency)(Number.parseFloat(f.amount||"0"))})]}),Number.parseFloat(f.amount||"0")!==(a.amount||0)&&(0,b.jsxs)("div",{className:"flex items-center justify-between pb-3 border-b border-primary/20",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:Number.parseFloat(f.amount||"0")>(a.amount||0)?"Overpaid:":"Balance Due:"}),(0,b.jsx)("span",{className:`text-lg font-bold ${Number.parseFloat(f.amount||"0")>(a.amount||0)?"text-green-600":"text-red-600"}`,children:(0,x.formatCurrency)(Math.abs(Number.parseFloat(f.amount||"0")-(a.amount||0)))})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm pt-2",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Dentist Share (50%):"}),(0,b.jsx)("span",{className:"font-semibold text-foreground",children:(0,x.formatCurrency)(.5*Number.parseFloat(f.amount||"0"))})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Clinic Share (50%):"}),(0,b.jsx)("span",{className:"font-semibold text-foreground",children:(0,x.formatCurrency)(.5*Number.parseFloat(f.amount||"0"))})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)(g.Button,{type:"button",onClick:d,variant:"outline",className:"flex-1 h-11 bg-transparent",children:"Cancel"}),(0,b.jsxs)(g.Button,{type:"submit",className:"flex-1 h-11 bg-primary hover:bg-primary/90 text-primary-foreground font-bold",children:[(0,b.jsx)(E,{className:"w-4 h-4 mr-2"}),"Record Payment"]})]})]})]})]})})}function J({appointment:a,onClose:c}){return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)(f.Card,{className:"w-full max-w-lg bg-card",children:[(0,b.jsxs)(f.CardHeader,{className:"border-b border-border relative",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center",children:(0,b.jsx)(r.CheckCircle,{className:"w-6 h-6 text-green-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(f.CardTitle,{className:"text-xl",children:"Appointment Created Successfully!"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"The appointment has been scheduled"})]})]}),(0,b.jsx)("button",{onClick:c,className:"absolute top-4 right-4 p-1 hover:bg-muted rounded-lg transition-colors",children:(0,b.jsx)(y.X,{className:"w-5 h-5 text-muted-foreground"})})]}),(0,b.jsxs)(f.CardContent,{className:"pt-6 space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Patient"}),(0,b.jsx)("span",{className:"font-medium",children:a.patient_name||"Unknown"})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Dentist"}),(0,b.jsx)("span",{className:"font-medium",children:a.dentist_name||"Assigned"})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Date"}),(0,b.jsx)("span",{className:"font-medium",children:a.date})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Time"}),(0,b.jsx)("span",{className:"font-medium",children:a.time})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Service"}),(0,b.jsx)("span",{className:"font-medium",children:a.service||"Not specified"})]})]}),(0,b.jsx)("div",{className:"pt-4 flex gap-3",children:(0,b.jsx)(g.Button,{onClick:c,className:"flex-1 bg-primary hover:bg-primary/90",children:"Done"})})]})]})})}function K(){let{user:a}=(0,d.useAuth)(),[s,u]=(0,c.useState)([]),[y,B]=(0,c.useState)(!0),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1),[K,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(null),[R,S]=(0,c.useState)("all");(0,c.useEffect)(()=>{T()},[]);let T=async()=>{try{B(!0);let a=await w.appointmentService.getAll();u(a||[])}catch(a){console.error("[v0] Error loading appointments:",a)}finally{B(!1)}},U=[{label:"Dashboard",icon:(0,b.jsx)(h.LayoutDashboard,{className:"w-5 h-5"}),href:"/hr/dashboard"},{label:"Patients",icon:(0,b.jsx)(i.Users,{className:"w-5 h-5"}),href:"/hr/patients"},{label:"Appointments",icon:(0,b.jsx)(j.Calendar,{className:"w-5 h-5"}),href:"/hr/appointments"},{label:"Treatments",icon:(0,b.jsx)(k.Bluetooth,{className:"w-5 h-5"}),href:"/hr/treatments"},{label:"Payments",icon:(0,b.jsx)(l.CreditCard,{className:"w-5 h-5"}),href:"/hr/payments"},{label:"Inventory",icon:(0,b.jsx)(m.Package,{className:"w-5 h-5"}),href:"/hr/inventory"},{label:"Reports",icon:(0,b.jsx)(n.BarChart3,{className:"w-5 h-5"}),href:"/hr/reports"},{label:"Settings",icon:(0,b.jsx)(o.Settings,{className:"w-5 h-5"}),href:"/hr/settings"}],V=async a=>{try{console.log("[v0] HR creating appointment with data:",a);let b=await w.appointmentService.create(a);console.log("[v0] ✅ Appointment created successfully:",b),u([b,...s]),D(!1),O({patient_name:a.patient_name,dentist_name:a.dentist_name,date:a.date,time:a.time,service:a.service}),M(!0)}catch(b){let a=b instanceof Error?b.message:JSON.stringify(b);console.error("[v0] Error scheduling appointment:",a),alert(`Error creating appointment: ${a}`)}},W=async a=>{if(P)try{let b=await w.appointmentService.update(P.id,{dentist_id:a,status:"pending"});u(s.map(a=>a.id===P.id?b:a));try{await w.treatmentRecordService.create({appointment_id:P.id,patient_id:P.patient_id,dentist_id:a,description:"Assigned appointment by HR",notes:`Assigned on ${new Date().toISOString()}`,date:new Date().toISOString()})}catch(a){console.warn("[v0] Warning creating treatment record for assignment:",a)}F(!1),Q(null)}catch(b){let a=b instanceof Error?b.message:JSON.stringify(b);console.error("[v0] Error assigning dentist:",a),alert(`Error: ${a}`)}},X=async a=>{if(confirm("Are you sure you want to cancel this appointment?"))try{await w.appointmentService.delete(a),u(s.filter(b=>b.id!==a))}catch(a){console.error("[v0] Error deleting appointment:",a)}},Y=async(a,b)=>{try{let c=await w.appointmentService.changeStatus(a,b);u(s.map(b=>b.id===a?c:b))}catch(a){console.error("[v0] Error updating appointment status:",a)}},Z=a=>{Q(a),F(!0)},$=async a=>{if(!P)return"";try{let b=await w.paymentService.create({patient_id:P.patient_id,dentist_id:P.dentist_id||"",appointment_id:P.id,amount:a.amount,method:a.method,status:"paid",description:a.notes,date:new Date().toISOString().split("T")[0]});return await w.appointmentService.update(P.id,{status:"paid"}),await T(),b.id}catch(a){throw console.error("[v0] Error recording payment:",a),Error("Failed to record payment: "+(a instanceof Error?a.message:"Unknown error"))}},_=async a=>{try{await w.appointmentService.update(a,{status:"attended"}),await T(),console.log("[v0] ✅ Appointment marked as attended")}catch(a){console.error("[v0] Error marking as attended:",a),alert("Failed to mark appointment as attended")}},aa="all"===R?s:s.filter(a=>a.status===R),ab={pending:aa.filter(a=>"pending"===a.status),confirmed:aa.filter(a=>"confirmed"===a.status),attended:aa.filter(a=>"attended"===a.status),inProgress:aa.filter(a=>"in-progress"===a.status),completed:aa.filter(a=>"completed"===a.status),paid:aa.filter(a=>"paid"===a.status)};return(0,b.jsxs)(e.default,{navItems:U,title:"Appointment Management",children:[(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Schedule Appointments"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage patient bookings and dentist assignments"})]}),(0,b.jsxs)(g.Button,{onClick:()=>D(!0),className:"bg-primary hover:bg-primary/90 text-primary-foreground gap-2",children:[(0,b.jsx)(p.Plus,{className:"w-4 h-4"}),"New Appointment"]})]}),ab.completed.length>0&&(0,b.jsxs)(f.Card,{className:"border-green-300 bg-green-50/50 shadow-lg",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2 text-green-900",children:[(0,b.jsx)(r.CheckCircle,{className:"w-5 h-5 text-green-600"}),"Completed Appointments - Ready for Payment (",ab.completed.length,")"]}),(0,b.jsx)("p",{className:"text-sm text-green-700",children:"Click on any appointment to record payment"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ab.completed.map(a=>(0,b.jsxs)("button",{onClick:()=>{Q(a),H(!0)},className:"p-5 border-2 border-green-300 bg-white rounded-lg hover:bg-green-50 hover:border-green-500 transition-all text-left group",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-bold text-lg text-foreground group-hover:text-primary",children:a.patients?.name||"Unknown Patient"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[(0,b.jsx)("span",{className:"font-medium",children:a.service||"General Visit"}),a.dentists?.name&&` • Dr. ${a.dentists.name}`]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"font-bold text-primary",children:a.date}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.time})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-green-200",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-green-700 bg-green-100 px-2 py-1 rounded",children:"✓ COMPLETED"}),(0,b.jsx)("span",{className:"text-sm font-bold text-primary group-hover:underline",children:"Record Payment →"})]})]},a.id))})})]}),ab.paid.length>0&&(0,b.jsxs)(f.Card,{className:"border-blue-300 bg-blue-50/50",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2 text-blue-900",children:[(0,b.jsx)(l.CreditCard,{className:"w-5 h-5 text-blue-600"}),"Paid Appointments (",ab.paid.length,")"]}),(0,b.jsx)("p",{className:"text-sm text-blue-700",children:"Appointments with recorded payments"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ab.paid.map(a=>(0,b.jsxs)("div",{className:"p-5 border-2 border-blue-200 bg-white rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-bold text-lg text-foreground",children:a.patients?.name||"Unknown Patient"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[(0,b.jsx)("span",{className:"font-medium",children:a.service||"General Visit"}),a.dentists?.name&&` • Dr. ${a.dentists.name}`]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"font-bold text-primary",children:a.date}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.time})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-blue-200",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-blue-700 bg-blue-100 px-2 py-1 rounded",children:"✓ PAID"}),a.amount&&(0,b.jsx)("span",{className:"text-sm font-bold text-blue-900",children:(0,x.formatCurrency)(a.amount)})]})]},a.id))})})]}),ab.confirmed.length>0&&(0,b.jsxs)(f.Card,{className:"border-purple-300 bg-purple-50/50 shadow-lg",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2 text-purple-900",children:[(0,b.jsx)(r.CheckCircle,{className:"w-5 h-5 text-purple-600"}),"Confirmed Appointments - Patient Check-In (",ab.confirmed.length,")"]}),(0,b.jsx)("p",{className:"text-sm text-purple-700",children:"Mark patients as attended when they arrive"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ab.confirmed.map(a=>(0,b.jsxs)("div",{className:"p-5 border-2 border-purple-300 bg-white rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-bold text-lg text-foreground",children:a.patients?.name||"Unknown Patient"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[(0,b.jsx)("span",{className:"font-medium",children:a.service||"General Visit"}),a.dentists?.name&&` • Dr. ${a.dentists.name}`]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"font-bold text-primary",children:a.date}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.time})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 pt-3 border-t border-purple-200",children:[(0,b.jsx)("span",{className:"text-xs font-semibold text-purple-700 bg-purple-100 px-2 py-1 rounded flex-1",children:"✓ CONFIRMED"}),(0,b.jsx)(g.Button,{onClick:()=>_(a.id),size:"sm",className:"bg-purple-600 hover:bg-purple-700 text-white",children:"Mark Attended"})]})]},a.id))})})]}),ab.pending.length>0&&(0,b.jsxs)(f.Card,{className:"border-blue-300 bg-blue-50/50",children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2 text-blue-900",children:[(0,b.jsx)(t.Clock,{className:"w-5 h-5 text-blue-600"}),"Patient Booking Requests (",ab.pending.length,")"]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:ab.pending.map(a=>(0,b.jsxs)("div",{className:"p-4 border-2 border-blue-300 bg-white rounded-lg hover:bg-blue-50/30 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold text-lg text-foreground",children:a.patients?.name||"Unknown Patient"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.service||"General Visit",a.dentist_id?` with Dr. ${a.dentists?.name}`:" - Dentist needed"]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"font-bold text-primary",children:a.date}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.time})]})]}),a.notes&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-3 p-2 bg-muted/50 rounded",children:[(0,b.jsx)("span",{className:"font-medium",children:"Patient Notes:"})," ",a.notes]}),(0,b.jsx)("div",{className:"flex gap-2",children:a.dentist_id?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("p",{className:"flex-1 text-sm text-muted-foreground pt-2",children:"Dentist assigned, awaiting approval"}),(0,b.jsx)(g.Button,{size:"sm",variant:"outline",onClick:()=>Z(a),className:"text-xs",children:"Change"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(g.Button,{onClick:()=>Z(a),className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium",children:[(0,b.jsx)(v,{className:"w-4 h-4 mr-2"}),"Assign Dentist"]}),(0,b.jsx)(g.Button,{size:"sm",variant:"outline",onClick:()=>X(a.id),children:(0,b.jsx)(q.Trash2,{className:"w-3 h-3"})})]})})]},a.id))})})]}),(0,b.jsx)("div",{className:"flex gap-2",children:["all","pending","confirmed","completed","paid"].map(a=>(0,b.jsxs)("button",{onClick:()=>S(a),className:`px-4 py-2 rounded-lg font-medium transition-colors ${R===a?"bg-primary text-primary-foreground":"bg-muted text-foreground hover:bg-muted/80"}`,children:[a.charAt(0).toUpperCase()+a.slice(1),"all"!==a&&` (${ab[a]?.length||0})`]},a))}),y?(0,b.jsx)(f.Card,{children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(0,b.jsx)("div",{className:"text-center text-muted-foreground",children:"Loading appointments..."})})}):(0,b.jsx)("div",{className:"space-y-4",children:"all"===R?(0,b.jsxs)(b.Fragment,{children:[ab.pending.length>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(t.Clock,{className:"w-5 h-5 text-yellow-600"}),"Pending Approval (",ab.pending.length,")"]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:ab.pending.map(a=>(0,b.jsx)(L,{appointment:a,onStatusChange:Y,onDelete:X},a.id))})})]}),ab.confirmed.length>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(r.CheckCircle,{className:"w-5 h-5 text-green-600"}),"Confirmed (",ab.confirmed.length,")"]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:ab.confirmed.map(a=>(0,b.jsx)(L,{appointment:a,onStatusChange:Y,onDelete:X},a.id))})})]}),ab.completed.length>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(r.CheckCircle,{className:"w-5 h-5 text-green-600"}),"Completed (",ab.completed.length,")"]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:ab.completed.map(a=>(0,b.jsx)(L,{appointment:a,onStatusChange:Y,onDelete:X},a.id))})})]})]}):(0,b.jsx)(f.Card,{children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(0,b.jsx)("div",{className:"space-y-3",children:aa.map(a=>(0,b.jsx)(L,{appointment:a,onStatusChange:Y,onDelete:X},a.id))})})})})]}),C&&(0,b.jsx)(z,{onClose:()=>D(!1),onSubmit:V}),K&&N&&(0,b.jsx)(J,{appointment:N,onClose:()=>{M(!1),O(null)}}),E&&P&&(0,b.jsx)(A,{appointment:P,onClose:()=>F(!1),onAssign:W}),G&&P&&(0,b.jsx)(I,{appointment:P,onClose:()=>{H(!1),Q(null)},onRecordPayment:$})]})}function L({appointment:a,onStatusChange:c,onDelete:d}){return(0,b.jsxs)("div",{className:"p-4 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold text-foreground",children:a.patients?.name||"Unknown Patient"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.service||"General Visit"," with ",a.dentists?.name||"Unassigned"]})]}),(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${"confirmed"===a.status?"bg-green-100 text-green-700":"pending"===a.status?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:a.status.charAt(0).toUpperCase()+a.status.slice(1)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.date," at ",a.time]}),(0,b.jsxs)("div",{className:"flex gap-2",children:["pending"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(g.Button,{size:"sm",onClick:()=>c(a.id,"confirmed"),className:"bg-green-600 hover:bg-green-700 text-white text-xs",children:[(0,b.jsx)(r.CheckCircle,{className:"w-3 h-3 mr-1"}),"Confirm"]}),(0,b.jsxs)(g.Button,{size:"sm",onClick:()=>c(a.id,"cancelled"),variant:"outline",className:"text-xs",children:[(0,b.jsx)(s.XCircle,{className:"w-3 h-3 mr-1"}),"Reject"]})]}),(0,b.jsx)(g.Button,{size:"sm",variant:"outline",className:"text-xs text-destructive hover:bg-destructive/10 bg-transparent",onClick:()=>d(a.id),children:(0,b.jsx)(q.Trash2,{className:"w-3 h-3"})})]})]})]})}a.s(["default",()=>K],29230)}];

//# sourceMappingURL=app_hr_appointments_page_tsx_e681fdde._.js.map