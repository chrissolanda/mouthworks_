module.exports=[29230,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(21937),e=a.i(96313),f=a.i(3130),g=a.i(40695),h=a.i(30617),i=a.i(60246),j=a.i(41675),k=a.i(34422),l=a.i(11156),m=a.i(83497),n=a.i(39761),o=a.i(21161),p=a.i(15618),q=a.i(81560),r=a.i(16201),s=a.i(62722),t=a.i(41710);let u=(0,a.i(70106).default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var v=a.i(2288),w=a.i(33508),x=a.i(97895);function y({onClose:a,onSubmit:d}){let[e,f]=(0,c.useState)({patient_id:"",patient_name:"",dentist_id:null,dentist_name:"",date:"",time:"",service:"",amount:0,notes:""}),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(null);(0,c.useEffect)(()=>{r()},[]);let r=async()=>{try{o(!0);let[a,b,c]=await Promise.all([v.patientService.getAll(),v.dentistService.getAll(),v.treatmentService.getAll()]);i(a||[]);let d=(b||[]).filter((a,b,c)=>{let d=(a?.email||"").trim().toLowerCase(),e=(a?.name||"").trim().toLowerCase(),f=d||e||a?.id;return c.findIndex(a=>{let b=(a?.email||"").trim().toLowerCase(),c=(a?.name||"").trim().toLowerCase();return(b||c||a?.id)===f})===b});k(d),m(c||[])}catch(a){q("Failed to load patients/dentists/services"),console.error("Error loading data:",a)}finally{o(!1)}},s=a=>{let{name:b,value:c}=a.target;if("service"===b){let a=l.find(a=>a.name===c),b=a?.price||t(c);f(a=>({...a,service:c,amount:b}))}else f(a=>({...a,[b]:c}))},t=a=>({Cleaning:500,"Tooth Cleaning":500,"Dental Cleaning":500,Filling:800,"Dental Filling":800,"Tooth Filling":800,"Root Canal":1500,"Root Canal Treatment":1500,Extraction:600,"Tooth Extraction":600,Whitening:2e3,"Teeth Whitening":2e3,Checkup:300,"Dental Checkup":300,Consultation:300,Braces:3e3,"Dental Braces":3e3,Crown:2500,"Dental Crown":2500})[a]||500;return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-card rounded-lg shadow-2xl max-w-md w-full max-h-96 overflow-y-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border sticky top-0 bg-card",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-foreground",children:"Schedule Appointment"}),(0,b.jsx)("button",{onClick:a,className:"p-1 hover:bg-muted rounded-lg transition-colors",children:(0,b.jsx)(w.X,{className:"w-5 h-5"})})]}),p&&(0,b.jsx)("div",{className:"p-4 bg-destructive/10 text-destructive text-sm",children:p}),(0,b.jsxs)("form",{onSubmit:a=>{if(a.preventDefault(),e.patient_id&&e.dentist_id&&e.date&&e.time){let a={patient_id:e.patient_id,dentist_id:e.dentist_id,date:e.date,time:e.time,service:e.service,notes:e.notes,status:"pending"};console.log("[v0] Submitting appointment for service:",e.service,"(price: ₱"+e.amount+" will be charged when completed)"),d(a)}else q("Please fill in all required fields including selecting a dentist")},className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Patient *"}),n?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading patients..."}):(0,b.jsxs)("select",{name:"patient_id",value:e.patient_id,onChange:a=>{let b=a.target.value,c=h.find(a=>a.id===b);f(a=>({...a,patient_id:b,patient_name:c?.name||""}))},className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select patient..."}),h.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-sm font-medium text-foreground",children:["Dentist ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),n?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading dentists..."}):0===j.length?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"No dentists available. Please add dentists first."}):(0,b.jsxs)("select",{name:"dentist_id",value:e.dentist_id||"",onChange:a=>{let b=a.target.value,c=j.find(a=>a.id===b);f(a=>({...a,dentist_id:""===b?null:b,dentist_name:c?.name||""}))},className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select dentist..."}),j.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"The selected dentist will be notified to approve this appointment"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Service"}),n?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading services..."}):0===l.length?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"No services available"}):(0,b.jsxs)("select",{name:"service",value:e.service,onChange:s,className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select service..."}),l.map(a=>(0,b.jsxs)("option",{value:a.name,children:[a.name," ",a.price?`- ${(0,x.formatCurrency)(a.price)}`:""]},a.id))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Date *"}),(0,b.jsx)("input",{type:"date",name:"date",value:e.date,onChange:s,className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Time *"}),(0,b.jsxs)("select",{name:"time",value:e.time,onChange:s,className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select time..."}),["09:00","10:00","11:00","14:00","15:00","16:00","17:00"].map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Notes (Optional)"}),(0,b.jsx)("textarea",{name:"notes",value:e.notes,onChange:s,placeholder:"Any special notes...",className:"w-full p-2 border border-border rounded-lg text-sm resize-none bg-background text-foreground",rows:3})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,b.jsx)(g.Button,{type:"button",onClick:a,variant:"outline",className:"flex-1 bg-transparent",children:"Cancel"}),(0,b.jsx)(g.Button,{type:"submit",className:"flex-1 bg-primary hover:bg-primary/90 text-primary-foreground",disabled:n,children:"Schedule"})]})]})]})})}function z({appointment:a,onClose:d,onAssign:e}){let[f,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(!0);return(0,c.useEffect)(()=>{(async()=>{try{let a=await v.dentistService.getAll().catch(()=>[]);h(a||[])}catch(a){console.error("[v0] Error loading dentists:",a)}finally{l(!1)}})()},[]),(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-card rounded-lg shadow-2xl max-w-md w-full",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-foreground",children:"Assign Dentist"}),(0,b.jsx)("button",{onClick:d,className:"p-1 hover:bg-muted rounded-lg transition-colors",children:(0,b.jsx)(w.X,{className:"w-5 h-5"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-3",children:["Patient: ",(0,b.jsx)("span",{className:"font-semibold text-foreground",children:a.patients?.name||a.patientName})]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Service: ",(0,b.jsx)("span",{className:"font-semibold text-foreground",children:a.service})]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Date & Time: ",(0,b.jsxs)("span",{className:"font-semibold text-foreground",children:[a.date," at ",a.time]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-foreground",children:"Select Dentist"}),k?(0,b.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"Loading dentists..."}):0===f.length?(0,b.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No dentists available"}):(0,b.jsx)("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:f.map(a=>(0,b.jsxs)("button",{onClick:()=>j(a.id),className:`w-full p-3 border rounded-lg transition-colors text-left ${i===a.id?"border-primary bg-primary/10":"border-border hover:border-primary"}`,children:[(0,b.jsxs)("p",{className:"font-medium text-foreground",children:["Dr. ",a.name]}),a.specialization&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.specialization})]},a.id))})]})]}),(0,b.jsxs)("div",{className:"p-6 border-t border-border flex gap-2",children:[(0,b.jsx)(g.Button,{onClick:d,variant:"outline",className:"flex-1",children:"Cancel"}),(0,b.jsx)(g.Button,{onClick:()=>{i&&e(i)},disabled:!i,className:"flex-1 bg-primary hover:bg-primary/90 text-primary-foreground",children:"Assign"})]})]})})}function A(){let{user:a}=(0,d.useAuth)(),[s,w]=(0,c.useState)([]),[x,A]=(0,c.useState)(!0),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)("all");(0,c.useEffect)(()=>{K()},[]);let K=async()=>{try{A(!0);let a=await v.appointmentService.getAll();w(a||[])}catch(a){console.error("[v0] Error loading appointments:",a)}finally{A(!1)}},L=[{label:"Dashboard",icon:(0,b.jsx)(h.LayoutDashboard,{className:"w-5 h-5"}),href:"/hr/dashboard"},{label:"Patients",icon:(0,b.jsx)(i.Users,{className:"w-5 h-5"}),href:"/hr/patients"},{label:"Appointments",icon:(0,b.jsx)(j.Calendar,{className:"w-5 h-5"}),href:"/hr/appointments"},{label:"Treatments",icon:(0,b.jsx)(k.Bluetooth,{className:"w-5 h-5"}),href:"/hr/treatments"},{label:"Payments",icon:(0,b.jsx)(l.CreditCard,{className:"w-5 h-5"}),href:"/hr/payments"},{label:"Inventory",icon:(0,b.jsx)(m.Package,{className:"w-5 h-5"}),href:"/hr/inventory"},{label:"Reports",icon:(0,b.jsx)(n.BarChart3,{className:"w-5 h-5"}),href:"/hr/reports"},{label:"Settings",icon:(0,b.jsx)(o.Settings,{className:"w-5 h-5"}),href:"/hr/settings"}],M=async a=>{try{console.log("[v0] HR creating appointment with data:",a);let b=await v.appointmentService.create(a);console.log("[v0] ✅ Appointment created successfully:",b),w([b,...s]),D(!1),alert(`✅ Appointment created successfully!

Patient: ${a.patient_name||"Unknown"}
Dentist: ${a.dentist_name||"Assigned"}
Date: ${a.date}
Time: ${a.time}
Service: ${a.service||"Not specified"}`)}catch(b){let a=b instanceof Error?b.message:JSON.stringify(b);console.error("[v0] Error scheduling appointment:",a),alert(`Error creating appointment: ${a}`)}},N=async a=>{if(G)try{let b=await v.appointmentService.update(G.id,{dentist_id:a,status:"pending"});w(s.map(a=>a.id===G.id?b:a));try{await v.treatmentRecordService.create({appointment_id:G.id,patient_id:G.patient_id,dentist_id:a,description:"Assigned appointment by HR",notes:`Assigned on ${new Date().toISOString()}`,date:new Date().toISOString()})}catch(a){console.warn("[v0] Warning creating treatment record for assignment:",a)}F(!1),H(null)}catch(b){let a=b instanceof Error?b.message:JSON.stringify(b);console.error("[v0] Error assigning dentist:",a),alert(`Error: ${a}`)}},O=async a=>{if(confirm("Are you sure you want to cancel this appointment?"))try{await v.appointmentService.delete(a),w(s.filter(b=>b.id!==a))}catch(a){console.error("[v0] Error deleting appointment:",a)}},P=async(a,b)=>{try{let c=await v.appointmentService.changeStatus(a,b);w(s.map(b=>b.id===a?c:b))}catch(a){console.error("[v0] Error updating appointment status:",a)}},Q=a=>{H(a),F(!0)},R="all"===I?s:s.filter(a=>a.status===I),S={pending:R.filter(a=>"pending"===a.status),confirmed:R.filter(a=>"confirmed"===a.status),completed:R.filter(a=>"completed"===a.status)};return(0,b.jsxs)(e.default,{navItems:L,title:"Appointment Management",children:[(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Schedule Appointments"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage patient bookings and dentist assignments"})]}),(0,b.jsxs)(g.Button,{onClick:()=>D(!0),className:"bg-primary hover:bg-primary/90 text-primary-foreground gap-2",children:[(0,b.jsx)(p.Plus,{className:"w-4 h-4"}),"New Appointment"]})]}),S.pending.length>0&&(0,b.jsxs)(f.Card,{className:"border-blue-300 bg-blue-50/50",children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2 text-blue-900",children:[(0,b.jsx)(t.Clock,{className:"w-5 h-5 text-blue-600"}),"Patient Booking Requests (",S.pending.length,")"]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:S.pending.map(a=>(0,b.jsxs)("div",{className:"p-4 border-2 border-blue-300 bg-white rounded-lg hover:bg-blue-50/30 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold text-lg text-foreground",children:a.patients?.name||"Unknown Patient"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.service||"General Visit",a.dentist_id?` with Dr. ${a.dentists?.name}`:" - Dentist needed"]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"font-bold text-primary",children:a.date}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.time})]})]}),a.notes&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-3 p-2 bg-muted/50 rounded",children:[(0,b.jsx)("span",{className:"font-medium",children:"Patient Notes:"})," ",a.notes]}),(0,b.jsx)("div",{className:"flex gap-2",children:a.dentist_id?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("p",{className:"flex-1 text-sm text-muted-foreground pt-2",children:"Dentist assigned, awaiting approval"}),(0,b.jsx)(g.Button,{size:"sm",variant:"outline",onClick:()=>Q(a),className:"text-xs",children:"Change"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(g.Button,{onClick:()=>Q(a),className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium",children:[(0,b.jsx)(u,{className:"w-4 h-4 mr-2"}),"Assign Dentist"]}),(0,b.jsx)(g.Button,{size:"sm",variant:"outline",onClick:()=>O(a.id),children:(0,b.jsx)(q.Trash2,{className:"w-3 h-3"})})]})})]},a.id))})})]}),(0,b.jsx)("div",{className:"flex gap-2",children:["all","pending","confirmed","completed"].map(a=>(0,b.jsxs)("button",{onClick:()=>J(a),className:`px-4 py-2 rounded-lg font-medium transition-colors ${I===a?"bg-primary text-primary-foreground":"bg-muted text-foreground hover:bg-muted/80"}`,children:[a.charAt(0).toUpperCase()+a.slice(1),"all"!==a&&` (${S[a]?.length||0})`]},a))}),x?(0,b.jsx)(f.Card,{children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(0,b.jsx)("div",{className:"text-center text-muted-foreground",children:"Loading appointments..."})})}):(0,b.jsx)("div",{className:"space-y-4",children:"all"===I?(0,b.jsxs)(b.Fragment,{children:[S.pending.length>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(t.Clock,{className:"w-5 h-5 text-yellow-600"}),"Pending Approval (",S.pending.length,")"]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:S.pending.map(a=>(0,b.jsx)(B,{appointment:a,onStatusChange:P,onDelete:O},a.id))})})]}),S.confirmed.length>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(r.CheckCircle,{className:"w-5 h-5 text-green-600"}),"Confirmed (",S.confirmed.length,")"]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:S.confirmed.map(a=>(0,b.jsx)(B,{appointment:a,onStatusChange:P,onDelete:O},a.id))})})]}),S.completed.length>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(r.CheckCircle,{className:"w-5 h-5 text-green-600"}),"Completed (",S.completed.length,")"]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:S.completed.map(a=>(0,b.jsx)(B,{appointment:a,onStatusChange:P,onDelete:O},a.id))})})]})]}):(0,b.jsx)(f.Card,{children:(0,b.jsx)(f.CardContent,{className:"pt-6",children:(0,b.jsx)("div",{className:"space-y-3",children:R.map(a=>(0,b.jsx)(B,{appointment:a,onStatusChange:P,onDelete:O},a.id))})})})})]}),C&&(0,b.jsx)(y,{onClose:()=>D(!1),onSubmit:M}),E&&G&&(0,b.jsx)(z,{appointment:G,onClose:()=>F(!1),onAssign:N})]})}function B({appointment:a,onStatusChange:c,onDelete:d}){return(0,b.jsxs)("div",{className:"p-4 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold text-foreground",children:a.patients?.name||"Unknown Patient"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.service||"General Visit"," with ",a.dentists?.name||"Unassigned"]})]}),(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${"confirmed"===a.status?"bg-green-100 text-green-700":"pending"===a.status?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:a.status.charAt(0).toUpperCase()+a.status.slice(1)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.date," at ",a.time]}),(0,b.jsxs)("div",{className:"flex gap-2",children:["pending"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(g.Button,{size:"sm",onClick:()=>c(a.id,"confirmed"),className:"bg-green-600 hover:bg-green-700 text-white text-xs",children:[(0,b.jsx)(r.CheckCircle,{className:"w-3 h-3 mr-1"}),"Confirm"]}),(0,b.jsxs)(g.Button,{size:"sm",onClick:()=>c(a.id,"cancelled"),variant:"outline",className:"text-xs",children:[(0,b.jsx)(s.XCircle,{className:"w-3 h-3 mr-1"}),"Reject"]})]}),(0,b.jsx)(g.Button,{size:"sm",variant:"outline",className:"text-xs text-destructive hover:bg-destructive/10 bg-transparent",onClick:()=>d(a.id),children:(0,b.jsx)(q.Trash2,{className:"w-3 h-3"})})]})]})]})}a.s(["default",()=>A],29230)}];

//# sourceMappingURL=app_hr_appointments_page_tsx_e681fdde._.js.map