{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Administrator/Downloads/mouthworks_/app/api/auth/quicklogins/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\nimport { createClient } from \"@supabase/supabase-js\"\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\r\nconst supabaseServiceRole = process.env.SUPABASE_SERVICE_ROLE || process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n\r\n// Only return the specific emails requested if they exist in auth\r\nconst TARGET_EMAILS = [\r\n  \"hr@mouthworks.com\",\r\n  \"sarah.smith@dental.com\",\r\n  \"john.doe@dental.com\",\r\n  \"emily.johnson@dental.com\",\r\n  \"michael.chen@dental.com\",\r\n  \"lisa.anderson@dental.com\",\r\n]\r\n\r\nexport async function GET(_req: NextRequest) {\r\n  try {\r\n    const supabase = createClient(supabaseUrl, supabaseServiceRole, {\r\n      auth: { autoRefreshToken: false, persistSession: false },\r\n    })\r\n\r\n    // Query profile tables to map emails to roles\r\n    // We can't list auth.users via anon; use service role to query application tables\r\n    const { data: dentists, error: dentistsErr } = await supabase\r\n      .from(\"dentists\")\r\n      .select(\"name, email\")\r\n      .in(\"email\", TARGET_EMAILS)\r\n\r\n    const { data: patients, error: patientsErr } = await supabase\r\n      .from(\"patients\")\r\n      .select(\"name, email\")\r\n      .in(\"email\", TARGET_EMAILS)\r\n\r\n    // HR/admin may be stored in a staff table; fallback to static email if not found\r\n    const hrEmail = \"hr@mouthworks.com\"\r\n\r\n    if (dentistsErr) console.warn(\"Error fetching dentists:\", dentistsErr.message)\r\n    if (patientsErr) console.warn(\"Error fetching patients:\", patientsErr.message)\r\n\r\n    const entries: Array<{ role: string; name: string; email: string }> = []\r\n\r\n    // HR entry\r\n    entries.push({ role: \"hr\", name: \"HR/Admin\", email: hrEmail })\r\n\r\n    // Dentist entries from DB\r\n    ;(dentists || []).forEach((d) => {\r\n      entries.push({ role: \"dentist\", name: d.name || \"Dentist\", email: d.email })\r\n    })\r\n\r\n    // If specific dentists missing from DB, still include as selectable emails\r\n    TARGET_EMAILS.filter((e) => e.endsWith(\"@dental.com\")).forEach((email) => {\r\n      if (!entries.find((x) => x.email === email)) {\r\n        entries.push({ role: \"dentist\", name: email.split(\"@\")[0], email })\r\n      }\r\n    })\r\n\r\n    // Patient examples (optional)\r\n    ;(patients || []).forEach((p) => {\r\n      entries.push({ role: \"patient\", name: p.name || \"Patient\", email: p.email })\r\n    })\r\n\r\n    return NextResponse.json(entries)\r\n  } catch (err) {\r\n    console.error(\"Quicklogins API error:\", err)\r\n    return NextResponse.json({ error: \"Failed to load quick login users\" }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM;AACN,MAAM,sBAAsB,QAAQ,GAAG,CAAC,qBAAqB;AAE7D,kEAAkE;AAClE,MAAM,gBAAgB;IACpB;IACA;IACA;IACA;IACA;IACA;CACD;AAEM,eAAe,IAAI,IAAiB;IACzC,IAAI;QACF,MAAM,WAAW,IAAA,yMAAY,EAAC,aAAa,qBAAqB;YAC9D,MAAM;gBAAE,kBAAkB;gBAAO,gBAAgB;YAAM;QACzD;QAEA,8CAA8C;QAC9C,kFAAkF;QAClF,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,SAClD,IAAI,CAAC,YACL,MAAM,CAAC,eACP,EAAE,CAAC,SAAS;QAEf,MAAM,EAAE,MAAM,QAAQ,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,SAClD,IAAI,CAAC,YACL,MAAM,CAAC,eACP,EAAE,CAAC,SAAS;QAEf,iFAAiF;QACjF,MAAM,UAAU;QAEhB,IAAI,aAAa,QAAQ,IAAI,CAAC,4BAA4B,YAAY,OAAO;QAC7E,IAAI,aAAa,QAAQ,IAAI,CAAC,4BAA4B,YAAY,OAAO;QAE7E,MAAM,UAAgE,EAAE;QAExE,WAAW;QACX,QAAQ,IAAI,CAAC;YAAE,MAAM;YAAM,MAAM;YAAY,OAAO;QAAQ;QAG3D,CAAC,YAAY,EAAE,EAAE,OAAO,CAAC,CAAC;YACzB,QAAQ,IAAI,CAAC;gBAAE,MAAM;gBAAW,MAAM,EAAE,IAAI,IAAI;gBAAW,OAAO,EAAE,KAAK;YAAC;QAC5E;QAEA,2EAA2E;QAC3E,cAAc,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,CAAC,gBAAgB,OAAO,CAAC,CAAC;YAC9D,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC,IAAM,EAAE,KAAK,KAAK,QAAQ;gBAC3C,QAAQ,IAAI,CAAC;oBAAE,MAAM;oBAAW,MAAM,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;oBAAE;gBAAM;YACnE;QACF;QAGC,CAAC,YAAY,EAAE,EAAE,OAAO,CAAC,CAAC;YACzB,QAAQ,IAAI,CAAC;gBAAE,MAAM;gBAAW,MAAM,EAAE,IAAI,IAAI;gBAAW,OAAO,EAAE,KAAK;YAAC;QAC5E;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAmC,GAAG;YAAE,QAAQ;QAAI;IACxF;AACF"}}]
}