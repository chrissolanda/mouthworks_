(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,88879,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(91432),n=e.i(77395),r=e.i(70065),i=e.i(67881),l=e.i(60289),d=e.i(61911),o=e.i(87316),c=e.i(77176),m=e.i(61659),x=e.i(88844),u=e.i(17923),p=e.i(39616),h=e.i(7233),g=e.i(27612),f=e.i(69638),j=e.i(73884),b=e.i(3116),N=e.i(75254);let v=(0,N.default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var y=e.i(44496),C=e.i(47163),w=e.i(37727);function k({onClose:e,onSubmit:a}){let[n,r]=(0,s.useState)({patient_id:"",patient_name:"",dentist_id:null,dentist_name:"",date:"",time:"",service:"",amount:0,notes:""}),[l,d]=(0,s.useState)([]),[o,c]=(0,s.useState)([]),[m,x]=(0,s.useState)([]),[u,p]=(0,s.useState)(!0),[h,g]=(0,s.useState)(null);(0,s.useEffect)(()=>{f()},[]);let f=async()=>{try{p(!0);let[e,t,s]=await Promise.all([y.patientService.getAll(),y.dentistService.getAll(),y.treatmentService.getAll()]);d(e||[]);let a=(t||[]).filter((e,t,s)=>{let a=(e?.email||"").trim().toLowerCase(),n=(e?.name||"").trim().toLowerCase(),r=a||n||e?.id;return s.findIndex(e=>{let t=(e?.email||"").trim().toLowerCase(),s=(e?.name||"").trim().toLowerCase();return(t||s||e?.id)===r})===t});c(a),x(s||[])}catch(e){g("Failed to load patients/dentists/services"),console.error("Error loading data:",e)}finally{p(!1)}},j=e=>{let{name:t,value:s}=e.target;if("service"===t){let e=m.find(e=>e.name===s),t=e?.price||b(s);r(e=>({...e,service:s,amount:t}))}else r(e=>({...e,[t]:s}))},b=e=>({Cleaning:500,"Tooth Cleaning":500,"Dental Cleaning":500,Filling:800,"Dental Filling":800,"Tooth Filling":800,"Root Canal":1500,"Root Canal Treatment":1500,Extraction:600,"Tooth Extraction":600,Whitening:2e3,"Teeth Whitening":2e3,Checkup:300,"Dental Checkup":300,Consultation:300,Braces:3e3,"Dental Braces":3e3,Crown:2500,"Dental Crown":2500})[e]||500;return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-card rounded-lg shadow-2xl max-w-md w-full max-h-96 overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border sticky top-0 bg-card",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-foreground",children:"Schedule Appointment"}),(0,t.jsx)("button",{onClick:e,className:"p-1 hover:bg-muted rounded-lg transition-colors",children:(0,t.jsx)(w.X,{className:"w-5 h-5"})})]}),h&&(0,t.jsx)("div",{className:"p-4 bg-destructive/10 text-destructive text-sm",children:h}),(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),n.patient_id&&n.dentist_id&&n.date&&n.time){let e={patient_id:n.patient_id,dentist_id:n.dentist_id,date:n.date,time:n.time,service:n.service,notes:n.notes,status:"pending"};console.log("[v0] Submitting appointment for service:",n.service,"(price: ₱"+n.amount+" will be charged when completed)"),a(e)}else g("Please fill in all required fields including selecting a dentist")},className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Patient *"}),u?(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading patients..."}):(0,t.jsxs)("select",{name:"patient_id",value:n.patient_id,onChange:e=>{let t=e.target.value,s=l.find(e=>e.id===t);r(e=>({...e,patient_id:t,patient_name:s?.name||""}))},className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select patient..."}),l.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"text-sm font-medium text-foreground",children:["Dentist ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),u?(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading dentists..."}):0===o.length?(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"No dentists available. Please add dentists first."}):(0,t.jsxs)("select",{name:"dentist_id",value:n.dentist_id||"",onChange:e=>{let t=e.target.value,s=o.find(e=>e.id===t);r(e=>({...e,dentist_id:""===t?null:t,dentist_name:s?.name||""}))},className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select dentist..."}),o.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"The selected dentist will be notified to approve this appointment"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Service"}),u?(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading services..."}):0===m.length?(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"No services available"}):(0,t.jsxs)("select",{name:"service",value:n.service,onChange:j,className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select service..."}),m.map(e=>(0,t.jsxs)("option",{value:e.name,children:[e.name," ",e.price?`- ${(0,C.formatCurrency)(e.price)}`:""]},e.id))]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Date *"}),(0,t.jsx)("input",{type:"date",name:"date",value:n.date,onChange:j,className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Time *"}),(0,t.jsxs)("select",{name:"time",value:n.time,onChange:j,className:"w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select time..."}),["09:00","10:00","11:00","14:00","15:00","16:00","17:00"].map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Notes (Optional)"}),(0,t.jsx)("textarea",{name:"notes",value:n.notes,onChange:j,placeholder:"Any special notes...",className:"w-full p-2 border border-border rounded-lg text-sm resize-none bg-background text-foreground",rows:3})]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,t.jsx)(i.Button,{type:"button",onClick:e,variant:"outline",className:"flex-1 bg-transparent",children:"Cancel"}),(0,t.jsx)(i.Button,{type:"submit",className:"flex-1 bg-primary hover:bg-primary/90 text-primary-foreground",disabled:u,children:"Schedule"})]})]})]})})}function S({appointment:e,onClose:a,onAssign:n}){let[r,l]=(0,s.useState)([]),[d,o]=(0,s.useState)(""),[c,m]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{try{let e=await y.dentistService.getAll().catch(()=>[]);l(e||[])}catch(e){console.error("[v0] Error loading dentists:",e)}finally{m(!1)}})()},[]),(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-card rounded-lg shadow-2xl max-w-md w-full",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-foreground",children:"Assign Dentist"}),(0,t.jsx)("button",{onClick:a,className:"p-1 hover:bg-muted rounded-lg transition-colors",children:(0,t.jsx)(w.X,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mb-3",children:["Patient: ",(0,t.jsx)("span",{className:"font-semibold text-foreground",children:e.patients?.name||e.patientName})]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Service: ",(0,t.jsx)("span",{className:"font-semibold text-foreground",children:e.service})]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Date & Time: ",(0,t.jsxs)("span",{className:"font-semibold text-foreground",children:[e.date," at ",e.time]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-foreground",children:"Select Dentist"}),c?(0,t.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"Loading dentists..."}):0===r.length?(0,t.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No dentists available"}):(0,t.jsx)("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:r.map(e=>(0,t.jsxs)("button",{onClick:()=>o(e.id),className:`w-full p-3 border rounded-lg transition-colors text-left ${d===e.id?"border-primary bg-primary/10":"border-border hover:border-primary"}`,children:[(0,t.jsxs)("p",{className:"font-medium text-foreground",children:["Dr. ",e.name]}),e.specialization&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.specialization})]},e.id))})]})]}),(0,t.jsxs)("div",{className:"p-6 border-t border-border flex gap-2",children:[(0,t.jsx)(i.Button,{onClick:a,variant:"outline",className:"flex-1",children:"Cancel"}),(0,t.jsx)(i.Button,{onClick:()=>{d&&n(d)},disabled:!d,className:"flex-1 bg-primary hover:bg-primary/90 text-primary-foreground",children:"Assign"})]})]})})}var D=e.i(23750),A=e.i(84614),P=e.i(20286);let _=(0,N.default)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var T=e.i(40160);let E=(0,N.default)("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);var B=e.i(63835);function R({appointment:e,onClose:a,onRecordPayment:n}){let[r,l]=(0,s.useState)({amount:String(e.amount||0),method:"Cash",notes:`${e.service||"Treatment"} - ${e.date}`}),[d,c]=(0,s.useState)(null),[m,u]=(0,s.useState)(!1),p=e=>{let{name:t,value:s}=e.target;l(e=>({...e,[t]:s}))},h=async t=>{if(t.preventDefault(),r.amount&&r.notes)try{let t=await n({method:r.method,amount:Number.parseFloat(r.amount),notes:r.notes}),s={receiptNumber:"string"==typeof t?t:`RCP-${Date.now()}`,date:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),patientName:e.patients?.name||"Unknown Patient",patientEmail:e.patients?.email,dentistName:e.dentists?.name||"Not Assigned",service:e.service||e.treatment||"Treatment",amount:Number.parseFloat(r.amount),method:r.method,notes:r.notes};c(s),u(!0)}catch(e){console.error("Error recording payment:",e)}};return m&&d?(0,t.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:(0,t.jsx)("div",{className:"bg-card rounded-xl shadow-2xl max-w-md w-full",children:(0,t.jsxs)("div",{className:"p-6 text-center space-y-6",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full mx-auto flex items-center justify-center",children:(0,t.jsx)(_,{className:"w-8 h-8 text-green-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Payment Recorded!"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["Receipt #",d.receiptNumber," has been generated"]})]}),(0,t.jsxs)("div",{className:"bg-muted/50 rounded-lg p-4 text-left",children:[(0,t.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Amount:"}),(0,t.jsx)("span",{className:"font-bold",children:(0,C.formatCurrency)(d.amount)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Method:"}),(0,t.jsx)("span",{className:"font-medium",children:d.method})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)(i.Button,{onClick:()=>(0,B.downloadReceipt)(d),className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:[(0,t.jsx)(T.Download,{className:"w-4 h-4 mr-2"}),"Download Receipt"]}),(0,t.jsxs)(i.Button,{onClick:()=>(0,B.printReceipt)(d),variant:"outline",className:"w-full",children:[(0,t.jsx)(E,{className:"w-4 h-4 mr-2"}),"Print Receipt"]}),(0,t.jsx)(i.Button,{onClick:a,variant:"outline",className:"w-full mt-2",children:"Close"})]})]})})}):(0,t.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-card rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-border sticky top-0 bg-card z-10",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Complete Appointment & Record Payment"}),(0,t.jsx)("button",{onClick:a,className:"p-2 hover:bg-muted rounded-lg transition-colors",children:(0,t.jsx)(w.X,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"bg-muted/50 rounded-lg p-6 space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-foreground mb-4",children:"Appointment Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,t.jsx)(A.User,{className:"w-5 h-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Patient"}),(0,t.jsx)("p",{className:"text-base font-bold text-foreground",children:e.patients?.name||"Unknown"}),e.patients?.email&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.patients.email})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,t.jsx)(P.Stethoscope,{className:"w-5 h-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Dentist"}),(0,t.jsx)("p",{className:"text-base font-bold text-foreground",children:e.dentists?.name||"Not Assigned"})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,t.jsx)(o.Calendar,{className:"w-5 h-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Date & Time"}),(0,t.jsx)("p",{className:"text-base font-bold text-foreground",children:e.date}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.time})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,t.jsx)(x.Package,{className:"w-5 h-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Service / Treatment"}),(0,t.jsx)("p",{className:"text-base font-bold text-foreground",children:e.service||e.treatment||"Not Specified"})]})]})]})]}),(0,t.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-foreground",children:"Payment Information"}),(0,t.jsx)("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-blue-700",children:"Appointment Amount"}),(0,t.jsx)("p",{className:"text-xs text-blue-600",children:"Expected payment for this service"})]}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:(0,C.formatCurrency)(e.amount||0)})]})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-foreground",children:"Amount Paid by Patient (₱) *"}),(0,t.jsx)(D.Input,{name:"amount",type:"number",step:"0.01",value:r.amount,onChange:p,placeholder:"0.00",className:"border-border h-11 text-lg font-bold",required:!0}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enter the actual amount the patient paid"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-foreground",children:"Payment Method *"}),(0,t.jsxs)("select",{name:"method",value:r.method,onChange:p,className:"w-full px-3 py-2.5 h-11 border border-border rounded-lg bg-background text-foreground",required:!0,children:[(0,t.jsx)("option",{children:"Cash"}),(0,t.jsx)("option",{children:"Bank Transfer"}),(0,t.jsx)("option",{children:"Credit Card"}),(0,t.jsx)("option",{children:"Debit Card"}),(0,t.jsx)("option",{children:"Check"}),(0,t.jsx)("option",{children:"Insurance"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-foreground",children:"Notes / Description *"}),(0,t.jsx)("textarea",{name:"notes",value:r.notes,onChange:p,placeholder:"Payment details, receipt number, etc.",className:"w-full p-3 border border-border rounded-lg text-sm resize-none bg-background text-foreground",rows:3,required:!0})]}),(0,t.jsxs)("div",{className:"bg-primary/10 border-2 border-primary rounded-lg p-4 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between pb-3 border-b border-primary/20",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"Appointment Amount:"}),(0,t.jsx)("span",{className:"text-lg font-bold text-foreground",children:(0,C.formatCurrency)(e.amount||0)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pb-3 border-b border-primary/20",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Amount Paid:"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-primary",children:(0,C.formatCurrency)(Number.parseFloat(r.amount||"0"))})]}),Number.parseFloat(r.amount||"0")!==(e.amount||0)&&(0,t.jsxs)("div",{className:"flex items-center justify-between pb-3 border-b border-primary/20",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:Number.parseFloat(r.amount||"0")>(e.amount||0)?"Overpaid:":"Balance Due:"}),(0,t.jsx)("span",{className:`text-lg font-bold ${Number.parseFloat(r.amount||"0")>(e.amount||0)?"text-green-600":"text-red-600"}`,children:(0,C.formatCurrency)(Math.abs(Number.parseFloat(r.amount||"0")-(e.amount||0)))})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm pt-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Dentist Share (50%):"}),(0,t.jsx)("span",{className:"font-semibold text-foreground",children:(0,C.formatCurrency)(.5*Number.parseFloat(r.amount||"0"))})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Clinic Share (50%):"}),(0,t.jsx)("span",{className:"font-semibold text-foreground",children:(0,C.formatCurrency)(.5*Number.parseFloat(r.amount||"0"))})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)(i.Button,{type:"button",onClick:a,variant:"outline",className:"flex-1 h-11 bg-transparent",children:"Cancel"}),(0,t.jsxs)(i.Button,{type:"submit",className:"flex-1 h-11 bg-primary hover:bg-primary/90 text-primary-foreground font-bold",children:[(0,t.jsx)(_,{className:"w-4 h-4 mr-2"}),"Record Payment"]})]})]})]})]})})}function F({appointment:e,onClose:s}){return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)(r.Card,{className:"w-full max-w-lg bg-card",children:[(0,t.jsxs)(r.CardHeader,{className:"border-b border-border relative",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center",children:(0,t.jsx)(f.CheckCircle,{className:"w-6 h-6 text-green-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(r.CardTitle,{className:"text-xl",children:"Appointment Created Successfully!"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"The appointment has been scheduled"})]})]}),(0,t.jsx)("button",{onClick:s,className:"absolute top-4 right-4 p-1 hover:bg-muted rounded-lg transition-colors",children:(0,t.jsx)(w.X,{className:"w-5 h-5 text-muted-foreground"})})]}),(0,t.jsxs)(r.CardContent,{className:"pt-6 space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Patient"}),(0,t.jsx)("span",{className:"font-medium",children:e.patient_name||"Unknown"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Dentist"}),(0,t.jsx)("span",{className:"font-medium",children:e.dentist_name||"Assigned"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Date"}),(0,t.jsx)("span",{className:"font-medium",children:e.date})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Time"}),(0,t.jsx)("span",{className:"font-medium",children:e.time})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-3 bg-muted/50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Service"}),(0,t.jsx)("span",{className:"font-medium",children:e.service||"Not specified"})]})]}),(0,t.jsx)("div",{className:"pt-4 flex gap-3",children:(0,t.jsx)(i.Button,{onClick:s,className:"flex-1 bg-primary hover:bg-primary/90",children:"Done"})})]})]})})}function U(){let{user:e}=(0,a.useAuth)(),[j,N]=(0,s.useState)([]),[w,D]=(0,s.useState)(!0),[A,P]=(0,s.useState)(!1),[_,T]=(0,s.useState)(!1),[E,B]=(0,s.useState)(!1),[U,$]=(0,s.useState)(!1),[M,H]=(0,s.useState)(null),[q,I]=(0,s.useState)(null),[L,O]=(0,s.useState)("all");(0,s.useEffect)(()=>{V()},[]);let V=async()=>{try{D(!0);let e=await y.appointmentService.getAll();N(e||[])}catch(e){console.error("[v0] Error loading appointments:",e)}finally{D(!1)}},G=[{label:"Dashboard",icon:(0,t.jsx)(l.LayoutDashboard,{className:"w-5 h-5"}),href:"/hr/dashboard"},{label:"Patients",icon:(0,t.jsx)(d.Users,{className:"w-5 h-5"}),href:"/hr/patients"},{label:"Appointments",icon:(0,t.jsx)(o.Calendar,{className:"w-5 h-5"}),href:"/hr/appointments"},{label:"Treatments",icon:(0,t.jsx)(c.Bluetooth,{className:"w-5 h-5"}),href:"/hr/treatments"},{label:"Payments",icon:(0,t.jsx)(m.CreditCard,{className:"w-5 h-5"}),href:"/hr/payments"},{label:"Inventory",icon:(0,t.jsx)(x.Package,{className:"w-5 h-5"}),href:"/hr/inventory"},{label:"Reports",icon:(0,t.jsx)(u.BarChart3,{className:"w-5 h-5"}),href:"/hr/reports"},{label:"Settings",icon:(0,t.jsx)(p.Settings,{className:"w-5 h-5"}),href:"/hr/settings"}],X=async e=>{try{console.log("[v0] HR creating appointment with data:",e);let t=await y.appointmentService.create(e);console.log("[v0] ✅ Appointment created successfully:",t),N([t,...j]),P(!1),H({patient_name:e.patient_name,dentist_name:e.dentist_name,date:e.date,time:e.time,service:e.service}),$(!0)}catch(t){let e=t instanceof Error?t.message:JSON.stringify(t);console.error("[v0] Error scheduling appointment:",e),alert(`Error creating appointment: ${e}`)}},W=async e=>{if(q)try{let t=await y.appointmentService.update(q.id,{dentist_id:e,status:"pending"});N(j.map(e=>e.id===q.id?t:e));try{await y.treatmentRecordService.create({appointment_id:q.id,patient_id:q.patient_id,dentist_id:e,description:"Assigned appointment by HR",notes:`Assigned on ${new Date().toISOString()}`,date:new Date().toISOString()})}catch(e){console.warn("[v0] Warning creating treatment record for assignment:",e)}T(!1),I(null)}catch(t){let e=t instanceof Error?t.message:JSON.stringify(t);console.error("[v0] Error assigning dentist:",e),alert(`Error: ${e}`)}},J=async e=>{if(confirm("Are you sure you want to cancel this appointment?"))try{await y.appointmentService.delete(e),N(j.filter(t=>t.id!==e))}catch(e){console.error("[v0] Error deleting appointment:",e)}},K=async(e,t)=>{try{let s=await y.appointmentService.changeStatus(e,t);N(j.map(t=>t.id===e?s:t))}catch(e){console.error("[v0] Error updating appointment status:",e)}},Z=e=>{I(e),T(!0)},Q=async e=>{if(!q)return"";try{let t=await y.paymentService.create({patient_id:q.patient_id,dentist_id:q.dentist_id||"",appointment_id:q.id,amount:e.amount,method:e.method,status:"paid",description:e.notes,date:new Date().toISOString().split("T")[0]});return await y.appointmentService.update(q.id,{status:"paid"}),await V(),t.id}catch(e){throw console.error("[v0] Error recording payment:",e),Error("Failed to record payment: "+(e instanceof Error?e.message:"Unknown error"))}},Y=async e=>{try{await y.appointmentService.update(e,{status:"attended"}),await V(),console.log("[v0] ✅ Appointment marked as attended")}catch(e){console.error("[v0] Error marking as attended:",e),alert("Failed to mark appointment as attended")}},ee="all"===L?j:j.filter(e=>e.status===L),et={pending:ee.filter(e=>"pending"===e.status),confirmed:ee.filter(e=>"confirmed"===e.status),attended:ee.filter(e=>"attended"===e.status),inProgress:ee.filter(e=>"in-progress"===e.status),completed:ee.filter(e=>"completed"===e.status),paid:ee.filter(e=>"paid"===e.status)};return(0,t.jsxs)(n.default,{navItems:G,title:"Appointment Management",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Schedule Appointments"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage patient bookings and dentist assignments"})]}),(0,t.jsxs)(i.Button,{onClick:()=>P(!0),className:"bg-primary hover:bg-primary/90 text-primary-foreground gap-2",children:[(0,t.jsx)(h.Plus,{className:"w-4 h-4"}),"New Appointment"]})]}),et.completed.length>0&&(0,t.jsxs)(r.Card,{className:"border-green-300 bg-green-50/50 shadow-lg",children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsxs)(r.CardTitle,{className:"flex items-center gap-2 text-green-900",children:[(0,t.jsx)(f.CheckCircle,{className:"w-5 h-5 text-green-600"}),"Completed Appointments - Ready for Payment (",et.completed.length,")"]}),(0,t.jsx)("p",{className:"text-sm text-green-700",children:"Click on any appointment to record payment"})]}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:et.completed.map(e=>(0,t.jsxs)("button",{onClick:()=>{I(e),B(!0)},className:"p-5 border-2 border-green-300 bg-white rounded-lg hover:bg-green-50 hover:border-green-500 transition-all text-left group",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-bold text-lg text-foreground group-hover:text-primary",children:e.patients?.name||"Unknown Patient"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[(0,t.jsx)("span",{className:"font-medium",children:e.service||"General Visit"}),e.dentists?.name&&` • Dr. ${e.dentists.name}`]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"font-bold text-primary",children:e.date}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.time})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-green-200",children:[(0,t.jsx)("span",{className:"text-xs font-semibold text-green-700 bg-green-100 px-2 py-1 rounded",children:"✓ COMPLETED"}),(0,t.jsx)("span",{className:"text-sm font-bold text-primary group-hover:underline",children:"Record Payment →"})]})]},e.id))})})]}),et.paid.length>0&&(0,t.jsxs)(r.Card,{className:"border-blue-300 bg-blue-50/50",children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsxs)(r.CardTitle,{className:"flex items-center gap-2 text-blue-900",children:[(0,t.jsx)(m.CreditCard,{className:"w-5 h-5 text-blue-600"}),"Paid Appointments (",et.paid.length,")"]}),(0,t.jsx)("p",{className:"text-sm text-blue-700",children:"Appointments with recorded payments"})]}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:et.paid.map(e=>(0,t.jsxs)("div",{className:"p-5 border-2 border-blue-200 bg-white rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-bold text-lg text-foreground",children:e.patients?.name||"Unknown Patient"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[(0,t.jsx)("span",{className:"font-medium",children:e.service||"General Visit"}),e.dentists?.name&&` • Dr. ${e.dentists.name}`]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"font-bold text-primary",children:e.date}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.time})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-blue-200",children:[(0,t.jsx)("span",{className:"text-xs font-semibold text-blue-700 bg-blue-100 px-2 py-1 rounded",children:"✓ PAID"}),e.amount&&(0,t.jsx)("span",{className:"text-sm font-bold text-blue-900",children:(0,C.formatCurrency)(e.amount)})]})]},e.id))})})]}),et.confirmed.length>0&&(0,t.jsxs)(r.Card,{className:"border-purple-300 bg-purple-50/50 shadow-lg",children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsxs)(r.CardTitle,{className:"flex items-center gap-2 text-purple-900",children:[(0,t.jsx)(f.CheckCircle,{className:"w-5 h-5 text-purple-600"}),"Confirmed Appointments - Patient Check-In (",et.confirmed.length,")"]}),(0,t.jsx)("p",{className:"text-sm text-purple-700",children:"Mark patients as attended when they arrive"})]}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:et.confirmed.map(e=>(0,t.jsxs)("div",{className:"p-5 border-2 border-purple-300 bg-white rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-bold text-lg text-foreground",children:e.patients?.name||"Unknown Patient"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[(0,t.jsx)("span",{className:"font-medium",children:e.service||"General Visit"}),e.dentists?.name&&` • Dr. ${e.dentists.name}`]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"font-bold text-primary",children:e.date}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.time})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 pt-3 border-t border-purple-200",children:[(0,t.jsx)("span",{className:"text-xs font-semibold text-purple-700 bg-purple-100 px-2 py-1 rounded flex-1",children:"✓ CONFIRMED"}),(0,t.jsx)(i.Button,{onClick:()=>Y(e.id),size:"sm",className:"bg-purple-600 hover:bg-purple-700 text-white",children:"Mark Attended"})]})]},e.id))})})]}),et.pending.length>0&&(0,t.jsxs)(r.Card,{className:"border-blue-300 bg-blue-50/50",children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)(r.CardTitle,{className:"flex items-center gap-2 text-blue-900",children:[(0,t.jsx)(b.Clock,{className:"w-5 h-5 text-blue-600"}),"Patient Booking Requests (",et.pending.length,")"]})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"space-y-3",children:et.pending.map(e=>(0,t.jsxs)("div",{className:"p-4 border-2 border-blue-300 bg-white rounded-lg hover:bg-blue-50/30 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-semibold text-lg text-foreground",children:e.patients?.name||"Unknown Patient"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.service||"General Visit",e.dentist_id?` with Dr. ${e.dentists?.name}`:" - Dentist needed"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"font-bold text-primary",children:e.date}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.time})]})]}),e.notes&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mb-3 p-2 bg-muted/50 rounded",children:[(0,t.jsx)("span",{className:"font-medium",children:"Patient Notes:"})," ",e.notes]}),(0,t.jsx)("div",{className:"flex gap-2",children:e.dentist_id?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"flex-1 text-sm text-muted-foreground pt-2",children:"Dentist assigned, awaiting approval"}),(0,t.jsx)(i.Button,{size:"sm",variant:"outline",onClick:()=>Z(e),className:"text-xs",children:"Change"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Button,{onClick:()=>Z(e),className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium",children:[(0,t.jsx)(v,{className:"w-4 h-4 mr-2"}),"Assign Dentist"]}),(0,t.jsx)(i.Button,{size:"sm",variant:"outline",onClick:()=>J(e.id),children:(0,t.jsx)(g.Trash2,{className:"w-3 h-3"})})]})})]},e.id))})})]}),(0,t.jsx)("div",{className:"flex gap-2",children:["all","pending","confirmed","completed","paid"].map(e=>(0,t.jsxs)("button",{onClick:()=>O(e),className:`px-4 py-2 rounded-lg font-medium transition-colors ${L===e?"bg-primary text-primary-foreground":"bg-muted text-foreground hover:bg-muted/80"}`,children:[e.charAt(0).toUpperCase()+e.slice(1),"all"!==e&&` (${et[e]?.length||0})`]},e))}),w?(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsx)("div",{className:"text-center text-muted-foreground",children:"Loading appointments..."})})}):(0,t.jsx)("div",{className:"space-y-4",children:"all"===L?(0,t.jsxs)(t.Fragment,{children:[et.pending.length>0&&(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Clock,{className:"w-5 h-5 text-yellow-600"}),"Pending Approval (",et.pending.length,")"]})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"space-y-3",children:et.pending.map(e=>(0,t.jsx)(z,{appointment:e,onStatusChange:K,onDelete:J},e.id))})})]}),et.confirmed.length>0&&(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(f.CheckCircle,{className:"w-5 h-5 text-green-600"}),"Confirmed (",et.confirmed.length,")"]})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"space-y-3",children:et.confirmed.map(e=>(0,t.jsx)(z,{appointment:e,onStatusChange:K,onDelete:J},e.id))})})]}),et.completed.length>0&&(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(f.CheckCircle,{className:"w-5 h-5 text-green-600"}),"Completed (",et.completed.length,")"]})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"space-y-3",children:et.completed.map(e=>(0,t.jsx)(z,{appointment:e,onStatusChange:K,onDelete:J},e.id))})})]})]}):(0,t.jsx)(r.Card,{children:(0,t.jsx)(r.CardContent,{className:"pt-6",children:(0,t.jsx)("div",{className:"space-y-3",children:ee.map(e=>(0,t.jsx)(z,{appointment:e,onStatusChange:K,onDelete:J},e.id))})})})})]}),A&&(0,t.jsx)(k,{onClose:()=>P(!1),onSubmit:X}),U&&M&&(0,t.jsx)(F,{appointment:M,onClose:()=>{$(!1),H(null)}}),_&&q&&(0,t.jsx)(S,{appointment:q,onClose:()=>T(!1),onAssign:W}),E&&q&&(0,t.jsx)(R,{appointment:q,onClose:()=>{B(!1),I(null)},onRecordPayment:Q})]})}function z({appointment:e,onStatusChange:s,onDelete:a}){return(0,t.jsxs)("div",{className:"p-4 border border-border rounded-lg hover:bg-muted/50 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-semibold text-foreground",children:e.patients?.name||"Unknown Patient"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.service||"General Visit"," with ",e.dentists?.name||"Unassigned"]})]}),(0,t.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${"confirmed"===e.status?"bg-green-100 text-green-700":"pending"===e.status?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.date," at ",e.time]}),(0,t.jsxs)("div",{className:"flex gap-2",children:["pending"===e.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Button,{size:"sm",onClick:()=>s(e.id,"confirmed"),className:"bg-green-600 hover:bg-green-700 text-white text-xs",children:[(0,t.jsx)(f.CheckCircle,{className:"w-3 h-3 mr-1"}),"Confirm"]}),(0,t.jsxs)(i.Button,{size:"sm",onClick:()=>s(e.id,"cancelled"),variant:"outline",className:"text-xs",children:[(0,t.jsx)(j.XCircle,{className:"w-3 h-3 mr-1"}),"Reject"]})]}),(0,t.jsx)(i.Button,{size:"sm",variant:"outline",className:"text-xs text-destructive hover:bg-destructive/10 bg-transparent",onClick:()=>a(e.id),children:(0,t.jsx)(g.Trash2,{className:"w-3 h-3"})})]})]})]})}e.s(["default",()=>U],88879)}]);